<!doctype html><html lang=en><head><meta charset=utf-8><title>Raspbian で unrar コマンドが古かったので最新にした</title><script async src="https://www.googletagmanager.com/gtag/js?id=UA-XXXXXXXX-XX"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}
gtag('js',new Date());gtag('config','UA-XXXXXXXX-XX');</script><script data-goatcounter=https://iganari.github.io/count async src=//iganari.github.io/count.js></script><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><link rel=alternate type=application/rss+xml href=https://iganari.github.io/index.xml title="Escape from"><meta name=twitter:card content="summary"><meta name=twitter:title content="Raspbian で unrar コマンドが古かったので最新にした"><meta name=twitter:description content="unrar コマンドをアップデートする話です :)"><link rel=stylesheet href=https://iganari.github.io/fontawesome/css/all.min.css><link id=dark-mode-theme rel=stylesheet href=https://iganari.github.io/css/dark.css><script>var darkTheme=document.getElementById('dark-mode-theme')
var storedTheme=localStorage.getItem('dark-mode-storage')
if(storedTheme==='dark'){darkTheme.disabled=false}else if(storedTheme==='light'){darkTheme.disabled=true}</script><script src=https://iganari.github.io/js/bundle.js></script><script src=https://iganari.github.io/js/instantpage.min.js type=module defer></script><meta name=generator content="Hugo 0.79.1"></head><body><header><nav class=navbar><div class=nav><a href=https://iganari.github.io/ class=nav-logo><img src=https://iganari.github.io/images/icon.png width=50 height=50 alt=Logo></a><ul class=nav-links><li><a href=/about/ id=About><em class="fas fa-user fa-lg"></em></a></li><li><a href=/tags id=Tags><em class="fas fa-tag fa-lg"></em></a></li><li><a href=/search id=Search><em class="fas fa-search fa-lg"></em></a></li><li><a href=/archives id=Archives><em class="fas fa-archive fa-lg"></em></a></li></ul></div></nav><div class=intro-header><div class=container><div class=post-heading><h1>Raspbian で unrar コマンドが古かったので最新にした</h1><span class=meta-post><em class="fa fa-calendar-alt"></em>&nbsp;Mar 25, 2021</span></div></div></div></header><div class=container role=main><article class=article class=blog-post><p>unrar コマンドをアップデートする話です :)</p><hr><h1 id=注意点>注意点</h1><p>この記事は下記の記事のアーカイブです ;)</p><p><a href=https://iganari.hatenablog.com/entry/2021/03/25/212336>https://iganari.hatenablog.com/entry/2021/03/25/212336</a></p><h1 id=概要>概要</h1><p>Raspberry PI 専用の OS である、 Raspbian にて unrar コマンドが古かったので最新にしました</p><p>インターネット上で転がっている情報だとすこし情報が足りなかったので、今回の記事にまとめました</p><h1 id=実際にやってみる>実際にやってみる</h1><h3 id=確認>確認</h3><ul><li>OS のバージョンの確認</li></ul><pre><code>$ cat /etc/os-release
PRETTY_NAME=&quot;Raspbian GNU/Linux 10 (buster)&quot;
NAME=&quot;Raspbian GNU/Linux&quot;
VERSION_ID=&quot;10&quot;
VERSION=&quot;10 (buster)&quot;
VERSION_CODENAME=buster
ID=raspbian
ID_LIKE=debian
HOME_URL=&quot;http://www.raspbian.org/&quot;
SUPPORT_URL=&quot;http://www.raspbian.org/RaspbianForums&quot;
BUG_REPORT_URL=&quot;http://www.raspbian.org/RaspbianBugs&quot;
</code></pre><ul><li>アーキテクトの確認</li></ul><pre><code>$ uname -a
Linux raspberrypi 5.10.17-v7+ #1403 SMP Mon Feb 22 11:29:51 GMT 2021 armv7l GNU/Linux
</code></pre><ul><li>現状の unrar の確認</li></ul><pre><code>$ unrar --version
unrar 0.0.1

---&gt; これが古すぎる
</code></pre><ul><li>実行ファイルの確認</li></ul><pre><code>$ which unrar
/usr/bin/unrar
</code></pre><pre><code>$ ls -la /usr/bin/ | grep unrar
lrwxrwxrwx  1 root root         23 Mar 24 06:26 unrar -&gt; /etc/alternatives/unrar
-rwxr-xr-x  1 root root      31004 Oct 16  2017 unrar-free
</code></pre><pre><code>$ ls -la /etc/alternatives/unrar
lrwxrwxrwx 1 root root 19 Mar 24 06:26 /etc/alternatives/unrar -&gt; /usr/bin/unrar-free
</code></pre><h3 id=unrar-のアンインストール>unrar のアンインストール</h3><ul><li>古い unrar のアンインストール</li></ul><pre><code>sudo apt remove unrar unrar-free
</code></pre><ul><li>確認<ul><li>何も出なければOK</li></ul></li></ul><pre><code>which unrar
ls -la /usr/bin/ | grep unrar
</code></pre><h3 id=新しい-unrar-のインストール>新しい unrar のインストール</h3><ul><li>リポジトリの参照先を追加</li></ul><pre><code>echo &quot;deb-src http://mirrordirector.raspbian.org/raspbian/ $(cat /etc/os-release | grep VERSION_CODENAME | awk -F\= '{print $2}') main contrib non-free rpi&quot; | sudo tee -a /etc/apt/sources.list
</code></pre><ul><li>確認<ul><li>既存の deb-src をコメントアウトを取ればよいだけの可能性もある…</li></ul></li></ul><pre><code>$ cat /etc/apt/sources.list
deb http://raspbian.raspberrypi.org/raspbian/ buster main contrib non-free rpi
# Uncomment line below then 'apt-get update' to enable 'apt-get source'
#deb-src http://raspbian.raspberrypi.org/raspbian/ buster main contrib non-free rpi
deb-src http://mirrordirector.raspbian.org/raspbian/ buster main contrib non-free rpi
</code></pre><ul><li>apt のアップデート</li></ul><pre><code>sudo apt update
</code></pre><ul><li>作業ディレクトリを作成</li></ul><pre><code>mkdir -p /tmp/unrar-nonfree &amp;&amp; chmod 0777 /tmp/unrar-nonfree &amp;&amp; cd /tmp/unrar-nonfree
</code></pre><ul><li>unrar-nonfree に必要な依存関係をインストール</li></ul><pre><code>sudo apt build-dep unrar-nonfree
</code></pre><ul><li>unrar-nonfree ソースをダウンロードし、 .deb パッケージをビルド</li></ul><pre><code>sudo apt source -b unrar-nonfree
</code></pre><ul><li>生成された .deb パッケージをインストール<ul><li>unrar-nonfree のバージョンによって異なるため * を使用</li></ul></li></ul><pre><code>sudo dpkg -i unrar*.deb
</code></pre><p>&mdash;> これでインストールが出来ました :)</p><h3 id=新しい-unrar-の確認>新しい unrar の確認</h3><ul><li>Version の確認<ul><li>オプションが <code>version</code> なので注意</li><li>help みたいにオプションの説明も入ってくるので <code>head</code> で適宜情報をカットする</li></ul></li></ul><pre><code>unrar version
</code></pre><pre><code>### 例


$ unrar version | head -n 6

UNRAR 5.61 beta 1 freeware      Copyright (c) 1993-2018 Alexander Roshal

Usage:     unrar &lt;command&gt; -&lt;switch 1&gt; -&lt;switch N&gt; &lt;archive&gt; &lt;files...&gt;
               &lt;@listfiles...&gt; &lt;path_to_extract\&gt;
</code></pre><ul><li>実行ファイルの確認</li></ul><pre><code>$ which unrar
/usr/bin/unrar
</code></pre><pre><code>$ ls -la /usr/bin/ | grep unrar
lrwxrwxrwx  1 root root         23 Mar 24 06:40 unrar -&gt; /etc/alternatives/unrar
-rwxr-xr-x  1 root root     389048 Oct 24  2018 unrar-nonfree
</code></pre><pre><code>$ ls -la /etc/alternatives/unrar
lrwxrwxrwx 1 root root 22 Mar 24 06:40 /etc/alternatives/unrar -&gt; /usr/bin/unrar-nonfree
</code></pre><p>&mdash;> 今度は unrar-nofree が実体となっていることが分かります</p><ul><li>.deb パッケージを削除</li></ul><pre><code>cd &amp;&amp; rm -rv /tmp/unrar-nonfree
</code></pre><h3 id=注意点-1>注意点</h3><pre><code>sudo apt source -b unrar-nonfree
</code></pre><p>このコマンド実行中に <code>_apt</code> ユーザで一部作業をするので、 上記のコマンドは <code>_apt</code> ユーザがアクセスし作業出来るディレクトリでやる必要があります</p><pre><code>### 権限エラーの例

W: Download is performed unsandboxed as root as file 'unrar-nonfree_5.6.6-1.dsc' couldn't be accessed by user '_apt'. - pkgAcquire::Run (13: Permission denied)
</code></pre><h3 id=参考>参考</h3><pre><code>VadimBrodsky/install-unrar-nonfree-raspbian.sh
https://gist.github.com/VadimBrodsky/1f567067e2cd438312bb9fd57095a806
</code></pre><h1 id=まとめ>まとめ</h1><p>これで unrar コマンドのアップデート出来ました</p><p>Have fan !! :)</p><div class=blog-tags><a href=https://iganari.github.io/tags/raspbian/>Raspbian</a>&nbsp;
<a href=https://iganari.github.io/tags/raspberry-pi/>Raspberry Pi</a>&nbsp;
<a href=https://iganari.github.io/tags/unrar/>unrar</a>&nbsp;
<a href=https://iganari.github.io/tags/linux/>Linux</a>&nbsp;</div></article><div id=disqus_thread></div><script type=text/javascript>(function(){if(window.location.hostname=="localhost")return;var dsq=document.createElement('script');dsq.type='text/javascript';dsq.async=true;var disqus_shortname='yourdisqusshortname';dsq.src='//'+disqus_shortname+'.disqus.com/embed.js';(document.getElementsByTagName('head')[0]||document.getElementsByTagName('body')[0]).appendChild(dsq);})();</script><noscript>Please enable JavaScript to view the
<a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com/ class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div><footer><div><a href=https://twitter.com/iganari_ name=twitter><em class="fab fa-twitter"></em></a><a href=https://github.com/iganari name=github><em class="fab fa-github"></em></a><a href=https://www.linkedin.com/in/iganari/ name=LinkedIn><em class="fab fa-linkedin-in"></em></a><a href=link%20to%20social%20media name="name of social media"><em class="A icon from https://fontawesome.com/"></em></a><div class=container><p class="credits copyright"><a href=https://iganari.github.io/about>iganari</a>
&nbsp;&copy;
2021
&nbsp;/&nbsp;
<a href=https://iganari.github.io/>Escape from</a>
&nbsp;&ndash;&nbsp;
<em class="fas fa-moon" id=dark-mode-toggle></em></p><p class="credits theme-by">Powered By <a href=https://gohugo.io>Hugo</a>&nbsp;
Theme
<a href=https://github.com/matsuyoshi30/harbor>Harbor</a></p></div></footer></body></html>